---
import { Image } from 'astro:assets';
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import FormattedDate from '../components/FormattedDate.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<BaseLayout title={SITE_TITLE} description={SITE_DESCRIPTION}>
	<ul>
		{posts.map((post) => (
			<li>
				<a href={`/blog/${post.id}/`}>
					{post.data.heroImage && (
						<Image width={720} height={360} src={post.data.heroImage} alt="" />
					)}
					<span class="post-title">{post.data.title}</span>
					<span class="post-date">
						<FormattedDate date={post.data.pubDate} />
					</span>
				</a>
			</li>
		))}
	</ul>
</BaseLayout>

<style>
	ul {
		display: grid;
		grid-template-columns: 1fr 1fr;
		gap: var(--space-md);
		list-style: none;
		margin: 0;
		padding: 0;
	}
	li a {
		display: block;
		text-decoration: none;
		border: var(--border);
		background: var(--color-bg-alt);
		color: var(--color-text);
		transition: background 0.1s, color 0.1s;
		overflow: hidden;
	}
	li a:hover {
		background: var(--color-button-hover);
		color: var(--color-button-hover-text);
	}
	li a:hover .post-date {
		color: var(--color-button-hover-text);
	}
	li img {
		width: 100%;
		border-bottom: var(--border);
	}
	.post-title {
		display: block;
		font-family: var(--font-heading);
		font-size: 0.65rem;
		color: var(--color-text-bright);
		padding: var(--space-md) var(--space-md) var(--space-xs);
		line-height: 1.5;
	}
	li a:hover .post-title {
		color: var(--color-button-hover-text);
	}
	.post-date {
		display: block;
		color: var(--color-text-muted);
		font-size: 0.9rem;
		padding: 0 var(--space-md) var(--space-md);
	}
	@media (max-width: 600px) {
		ul {
			grid-template-columns: 1fr;
		}
	}
</style>
